import sys


ATTRIBUTE_MAP = {
    0b100000000000000000000000000: "PARTIAL_SECRETS_ACCOUNT",
    0b010000000000000000000000000: "NO_AUTH_DATA_REQUIRED",
    0b001000000000000000000000000: "TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION",
    0b000100000000000000000000000: "PASSWORD_EXPIRED",
    0b000010000000000000000000000: "DONT_REQUIRE_PREAUTH",
    0b000001000000000000000000000: "USE_DES_KEY_ONLY",
    0b000000100000000000000000000: "NOT_DELEGATED",
    0b000000010000000000000000000: "TRUSTED_FOR_DELEGATION",
    0b000000001000000000000000000: "SMARTCARD_REQUIRED",
    0b000000000100000000000000000: "MNS_LOGON_ACCOUNT",
    0b000000000010000000000000000: "DONT_EXPIRE_PASSWD",
    0b000000000000010000000000000: "SERVER_TRUST_ACCOUNT",
    0b000000000000001000000000000: "WORKSTATION_TRUST_ACCOUNT",
    0b000000000000000100000000000: "INTERDOMAIN_TRUST_ACCOUNT",
    0b000000000000000001000000000: "NORMAL_ACCOUNT",
    0b000000000000000000010000000: "ENCRYPTED_TEXT_PASSWORD_ALLOWED",
    0b000000000000000000001000000: "PASSWD_CANT_CHANGE",
    0b000000000000000000000100000: "PASSWD_NOTREQD",
    0b000000000000000000000010000: "LOCKOUT",
    0b000000000000000000000001000: "HOMEDIR_REQUIRED",
    0b000000000000000000000000010: "ACCOUNT_DISABLE"
}


if len(sys.argv) != 2:
    print("Usage: python ms-uac_calc.py <UserAccountControl value>")
else:
    input_value = sys.argv[1]
    binary_value = int(input_value, 10)

    attributes = []

    for bitmask, attribute in ATTRIBUTE_MAP.items():
        if binary_value & bitmask:
            attributes.append(attribute)

    print("UserAccountControl Value:", input_value)
    print("Corresponding Attributes:", ", ".join(attributes))